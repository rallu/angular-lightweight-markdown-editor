angular.module("angular-lightweight-markdown-editor-templates",[]).run(["$templateCache",function(t){t.put("angular-lightweight-markdown-template.html",'<div class="markdown-editor"><ul class="markdown-editor__actions"><li ng-repeat="control in markdownEditorCtrl.options.controls track by $index" ng-click="markdownEditorCtrl.action(control)" ng-class="{separator: control == \'separator\'}" ng-if="control != \'preview\'"><i ng-if="control != \'separator\'" class="{{markdownEditorCtrl.icons[control]}}"></i></li><li ng-if="markdownEditorCtrl.options.controls.indexOf(\'preview\') > -1" ng-click="markdownEditorCtrl.preview = !markdownEditorCtrl.preview" ng-show="markdownEditorCtrl.showdownEnabled" ng-class="{enabled: markdownEditorCtrl.preview}" class="preview">{{markdownEditorCtrl.translations.textPreview}}</li></ul><div class="markdown-editor__editorarea"><div ng-class="{nopreview: !markdownEditorCtrl.preview}"><textarea ng-model="markdownEditorCtrl.ngModel"></textarea></div><div class="markdown-editor__editorarea__preview" ng-if="markdownEditorCtrl.showdownEnabled" ng-show="markdownEditorCtrl.preview" ng-bind-html="markdownEditorCtrl.getHTML()"></div></div></div>')}]),function(){function t(){return{restrict:"E",templateUrl:"angular-lightweight-markdown-template.html",controller:e,controllerAs:"markdownEditorCtrl",scope:!0,bindToController:{ngModel:"=",textPreview:"@",textProvideText:"@",textProvideLink:"@",showPreview:"=",options:"="},require:["^form","ngModel"],link:function(t,e,n,r){t.textareaElement=e.find("textarea")[0];var i=(r[0],["name","required","minLength","maxLength","placeholder","selectionDirection","selectionStart","selectionEnd","spellcheck"]);angular.forEach(i,function(e){n[e]&&(t.textareaElement[e]=n[e])})}}}function e(t,e){this.preview=!1,"undefined"!=typeof this.showPreview&&(this.preview=this.showPreview),this.showdownEnabled="undefined"!=typeof showdown;for(var i in r)angular.isDefined(this[i])&&(r[i]=this[i]);this.translations=r,this.action=function(t){var r=s[t](this.ngModel,n(e.textareaElement));r!==!1&&(this.ngModel=r)},this.getHTML=function(){return this.showdownEnabled?o.makeHtml(this.ngModel):""},this.options=angular.extend({},a,this.options),this.icons=l}function n(t){return{start:t.selectionStart,end:t.selectionEnd,length:t.selectionEnd-t.selectionStart}}e.$inject=["$sce","$scope"],angular.module("angular-lightweight-markdown-editor",["ngSanitize","angular-lightweight-markdown-editor-templates"]).directive("markdownEditor",t);var r={textPreview:"Preview",textProvideText:"Please provide link text",textProvideLink:"Please provide link URL"};if("undefined"!=typeof showdown)var o=new showdown.Converter;var a={controls:["bold","italic","strikethrough","separator","heading","heading2","heading3","bullets","numbers","indent","code","separator","link","quote","separator","preview"]},s={bold:function(t,e){return 0==e.length?t:d.surround(t,e.start,e.end-e.start,"**","**")},italic:function(t,e){return 0==e.length?t:d.surround(t,e.start,e.end-e.start,"*","*")},bullets:function(t,e){return d.startLinesWith(t,e.start,e.end,"* ")},numbers:function(t,e){return d.startLinesWith(t,e.start,e.end,"1. ")},heading:function(t,e){return d.startLinesWith(t,e.start,e.end,"#")},heading2:function(t,e){return d.startLinesWith(t,e.start,e.end,"##")},heading3:function(t,e){return d.startLinesWith(t,e.start,e.end,"###")},strikethrough:function(t,e){return 0==e.length?t:d.surround(t,e.start,e.end-e.start,"--","--")},indent:function(t,e){return d.startLinesWith(t,e.start,e.end,"\t")},quote:function(t,e){return d.startLinesWith(t,e.start,e.end,"> ")},code:function(t,e){if(0==e.length)return t;var n=t.substr(0,e.start).lastIndexOf("\n")+1,r=t.substr(e.end).indexOf("\n");if(r==-1)var i=t.length;else var i=e.end+r+1;return[t.substr(0,n),"```\n",t.substr(n,i-n),"\n```\n",t.substr(i)].join("")},link:function(t,e){if(e.length>0)var n=t.substr(e.start,e.length);else{var n=prompt(r.textProvideText);if(!n)return!1}var i=prompt(r.textProvideLink);return!!i&&[t.substr(0,e.start),"["+n+"]","("+i+")",t.substr(e.end)].join("")}},d={surround:function(t,e,n,r,i){var o=t.substr(e,n);return[t.substr(0,e),r?r:"",o,i?i:"",t.substr(e+n)].join("")},startLinesWith:function(t,e,n,r){var i=d.indexes(t.substr(e,n-e),"\n",e),o=t.substr(0,e).lastIndexOf("\n")+1;t=[t.substr(0,o),r,t.substr(o)].join("");for(var a=0;a<i.length;a++)t=[t.substr(0,r.length*(a+1)+i[a]+1),r,t.substr(r.length*(a+1)+i[a]+1)].join("");return t},indexes:function(t,e,n){var r=[];for(i=0;i<t.length;++i)t.substring(i,i+e.length)==e&&r.push(i+n);return r}},l={bold:"ame-bold",italic:"ame-italic",strikethrough:"ame-strikethrough",heading:"ame-header",heading2:"ame-header",heading3:"ame-header",bullets:"ame-list-ul",numbers:"ame-list-ol",indent:"ame-indent",code:"ame-code",link:"ame-link",quote:"ame-quote-right"}}();